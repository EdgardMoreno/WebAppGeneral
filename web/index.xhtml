<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" >    

    <ui:composition template="./templates/templatePrincipal.xhtml">

        <ui:define name="header">

            <script>

                $(document).ready(function(){

                    var flgCajaAperturada = $("#form\\:idTxtCajaAperturada").val();
                    console.log("Load Page: flgCajaAperturada:" + flgCajaAperturada);
                    if (Number(flgCajaAperturada) == 0)
                        $("#idDivFinal").css("display", "inline-block");
                });

                
                function fnAjaxListenAperturaCaja(data) {
                    
                    console.log("status: " + data.status);
                    
                    switch (data.status) {
                        case "success":
                            var flgCajaAperturada = $("#form\\:idTxtCajaAperturada").val();
                            console.log("flgCajaAperturada:" + flgCajaAperturada);
                            if (Number(flgCajaAperturada) == 1){
                                $("#idDivFinal").css("display", "none");
                            }
                            break;
                    }
                };

            </script>

        </ui:define>

        <ui:define name="content">

            <div class="container">

                <p:growl id="message" showDetail="true" />
                
                <!-- ********************************** -->
                <!-- DATOS OCULTOS -->
                <!-- *********************************** -->
                <table class="ocultarObjeto">
                    <tr>
                        <td><label>Caja Aperturada?</label></td>
                        <td><h:inputText id="idTxtCajaAperturada" value="#{indexController.flgCajaAperturada}" /></td>
                    </tr>
                </table>
                
                <!-- ********************************** -->
                <!-- PANTALLA INGRESO MONTO APERTURA:   -->
                <!-- *********************************** -->
                
                <!-- IMPORTANTE: TODO EL CSS UTILIZADO ES DEL ARCHIVO DE FANCY BOX -->
                
                <div id="idDivFinal" class="jconfirm jconfirm-supervan jconfirm-open" style="display: none">
                    <div class="jconfirm-bg" style="transition-duration: 0.4s; transition-timing-function: cubic-bezier(0.36, 0.55, 0.19, 1);">

                    </div>
                    <div class="jconfirm-scrollpane">
                        <div class="jconfirm-row">
                            <div class="jconfirm-cell">
                                <div class="jconfirm-holder" style="padding-top: 40px; padding-bottom: 40px;">
                                    <div class="jc-bs3-container container">
                                        <div class="jc-bs3-row row justify-content-md-center justify-content-sm-center justify-content-xs-center justify-content-lg-center">
                                            <div class="jconfirm-box-container col-md-4 col-md-offset-4 " style="transform: translate(0px, 0px); transition-duration: 0.4s; transition-timing-function: cubic-bezier(0.36, 0.55, 0.19, 1);">

                                                <div class="jconfirm-content" style="background-color: white; border: 8px solid #C0C0C0; padding: 10px; border-radius: 15px"  >

                                                    <div id="idDivValidation" class="messageValidation" ></div>
                                                    
                                                    <div style="text-align: center">
                                                        <table style="margin: 0 auto;">
                                                            
                                                            <tr>
                                                                <th colspan="3" style="text-align: center;">
                                                                    <H3>Aperturar Caja</H3></th>
                                                            </tr>
                                                            <tr>
                                                                <td class="compra_panelGrid_1"><h:outputLabel value="Monto Apertura:"/></td>
                                                                <td>&nbsp;
                                                                    <h:inputText id="idMtoApertura"
                                                                                 autocomplete="off"
                                                                                 class="form-control" 
                                                                                 value="#{indexController.numMtoApertura}" 
                                                                                 onkeypress="return fnAllowOnlyDecimalNumbers(event)"
                                                                                 onblur="formatDecimal_2(this)" />
                                                                </td>
                                                                <td>&nbsp;
                                                                    <h:commandLink value="Aceptar" styleClass="btn btn-primary"
                                                                       onclick="return fnValidateIndexForm()">
                                                                        <f:ajax execute="idMtoApertura" render="idTxtCajaAperturada message" listener="#{indexController.openCashRegister()}" onevent="fnAjaxListenAperturaCaja"/>
                                                                    </h:commandLink>
                                                                </td>
                                                            </tr>                                                        
                                                        </table>
                                                        <br/>
                                                       
                                                    </div>

                                                </div>
                                            </div>

                                        </div>

                                    </div>

                                </div>

                            </div>

                        </div>

                    </div>

                </div>

            </div>

        </ui:define>

    </ui:composition>
</html>

