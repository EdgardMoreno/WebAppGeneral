<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"      
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"  >
    
    <f:metadata>        
        <f:viewParam name="titulo" value="#{cashRegisterController.desTituloPagina}"/>        
        <f:event type="preRenderView" listener="#{cashRegisterController.getParamsExternalPage}"/>
    </f:metadata>
    
    <ui:composition template="./templates/templatePrincipal.xhtml">
        
        <ui:define name="header">
            
            <script>
                
                /*Funcion que permite anular el documento*/
                function fnAnulDocu(idDocu){
                    /*Valor del IDDOCU obtenido de la fila de la tabla se setear temporalmemte
                     * en un INPUTTEXT para que luego se llamado desde el Managed Bean*/
                    console.log("idDocu:" + idDocu);
                    $("#form\\:idDocuSelected").val(idDocu);
                    
                    var message = "¿Está seguro de anular el documento seleccionado?";
                    fnShowDialogConfirm('form\\:idBtnAnulDocu', message);
                    return false;
                }
                
            </script>
                   
        </ui:define>
        
        <ui:define name="content">
            
                
                <div class="container">
                    
                    <div class="page-header" >
                        <h3>${cashRegisterController.desTituloPagina}</h3>
                    </div>

                    <h:panelGrid columns="5"
                                 width="600px"                                 
                                 columnClasses="form_label_4, 
                                                form_input_2, 
                                                form_label_4, 
                                                form_input_2,
                                                td-controls-1">

                        
                        <h:outputLabel value="Fecha Desde:"/>
                        <h:inputText value="#{cashRegisterController.desFecDesde}" styleClass="form-control datepicker" />
                        <h:outputLabel value="Fecha Hasta:"/>
                        <h:inputText value="#{cashRegisterController.desFecHasta}" styleClass="form-control datepicker" />
                        
                        <h:commandLink actionListener="#{cashRegisterController.filter()}" styleClass="btn btn-default">
                            <span class="glyphicon glyphicon-search"></span> Buscar
                        </h:commandLink>                        

                    </h:panelGrid>
                    <br/>
                    
                    <!-- ********************************** -->
                    <!-- ELEMENTOS OCULTOS -->
                    <!-- *********************************** -->
                   
                    
                    
                    <!-- ********************************** -->
                    <!-- LISTA DE DOCUMENTOS -->
                    <!-- *********************************** -->
                    <h:dataTable id="idTblDocuments" 
                                 var="item" 
                                 width="100%"
                                 value="#{cashRegisterController.listViDayBox}"                                  
                                 styleClass="table-bordered"
                                 columnClasses="table_style_id,
                                                table_style_code,
                                                table_style_code_small,
                                                table_style_date_2,
                                                table_style_date_2,
                                                table_style_price_small,
                                                table_style_price_small,                                                
                                                table_style_price_small,                                                
                                                table_style_price_small,
                                                table_style_price_small,
                                                table_style_price_small,
                                                table_style_price_small,
                                                table_style_price_small,
                                                table_style_action">                        

                        <h:column>
                            <f:facet name="header">Nro.</f:facet>#{cashRegisterController.listViDayBox.indexOf(item) + 1}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Vendedor</f:facet>#{item.desPers}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Estado</f:facet>#{item.desEsta}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Fec. Apertura</f:facet>#{item.fecApertura}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Fec. Cierre</f:facet>#{item.fecCierre}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Mto. Ape. Caja</f:facet>#{item.numEfectApertCaja}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Usu. Cheques / Monedas</f:facet>#{item.numEfectDenomTotal}
                        </h:column>                        
                                               
                        <h:column>
                            <f:facet name="header">Sist. Total (Efectivo)</f:facet>#{item.numEfectTotalSistema}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Descuadre (Efectivo)</f:facet>#{item.numEfectSobraFalta}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Usu. Total (Tarjeta)</f:facet>#{item.numTarjeTotalSiste}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Sist. Total (Tarjeta)</f:facet>#{item.numTarjeTotalSiste}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Descuadre (Tarjeta)</f:facet>#{item.numTarjeSobraFalta}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Total Venta Dia</f:facet>#{item.numTotalVenta}
                        </h:column>
                        
                        <h:column>
                            <h:commandLink action="#{cashRegisterController.viewDetail(item)}">
                                <span class="glyphicon glyphicon-info-sign" data-toggle="tooltip" title="Ver Detalle"></span>
                            </h:commandLink>                           
                        </h:column>
                    </h:dataTable>
                    
                </div>
            
            <h:commandLink id="idBtnAnulDocu" value="Anular Documento" style="display: none">
                <f:ajax execute="idDocuSelected" render="idTblDocuments" listener="#{cashRegisterController.viewDetail(item)}" />
            </h:commandLink>
            
        </ui:define>
    </ui:composition>
</html>